description: >
  Store artifacts as a gzip compressed tarball

  This can be a performance improvement when storing a large number of files or very large but highly compressible files such as logs.
parameters:
  tarball-name:
    type: string
    description: Name for the compressed tarball, must be unique within this job
  path:
    type: string
    description: Path to file or directory to store
steps:
  - run:
      name: Compressing << parameters.tarball-name >>
      environment:
        TARBALL_NAME: << parameters.tarball-name >>
        ARTIFACT_PATH: << parameters.path >>
      command: << include(scripts/store_compressed_artifacts.sh) >>
  - store_artifacts:
      name: Store << parameters.tarball-name >>
      path: /tmp/<< parameters.tarball-name >>
      destination: ""
